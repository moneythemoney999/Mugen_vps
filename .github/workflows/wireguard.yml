name: VPS WireGuard

on:
  workflow_dispatch:

jobs:
  construire:
    runs-on: ubuntu-latest
    steps:
      - name: Installer WireGuard et gÃ©nÃ©rer les clÃ©s
        run: |
          sudo apt update
          sudo apt install -y wireguard qrencode curl

          umask 077
          wg genkey | tee cle_privee_serveur | wg pubkey > cle_publique_serveur
          wg genkey | tee cle_privee_client | wg pubkey > cle_publique_client

          echo "=== ğŸ” ClÃ© privÃ©e serveur ==="
          cat cle_privee_serveur
          echo "=== ğŸ” ClÃ© publique serveur ==="
          cat cle_publique_serveur
          echo "=== ğŸ” ClÃ© privÃ©e client ==="
          cat cle_privee_client
          echo "=== ğŸ” ClÃ© publique client ==="
          cat cle_publique_client

          echo "=== ğŸŒ IP publique du VPS ==="
          curl ifconfig.me

          echo "=== âœ… TERMINE ==="
